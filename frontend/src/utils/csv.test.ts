import { expect, test } from 'vitest'
import { convertToCSV, flattenObject} from './csv.ts'

test('check out put', () => {

  const dummyJsonString = `[{"index":0,"type":"Text","name":"introtext","data":{},"start":292.60000002384186,"end":1417.8999999761581,"duration":1125.2999999523163},{"index":1,"type":"Text","name":"explanationtext","data":{},"start":1417.8999999761581,"end":1991.6000000238419,"duration":573.7000000476837},{"index":2,"type":"Text","name":"block_4_text","data":{},"start":1991.6000000238419,"end":2600.3000000715256,"duration":608.7000000476837},{"index":3,"type":"MasterMindleWrapper","name":"block_4_mastermindle","data":{"blockpos":"0","feedbacktype":4,"timelimit":40,"data":[{"type":"game","index":0,"start":2601.100000023842,"end":28036.800000071526,"duration":25435.700000047684,"data":{"solution":["blue","red","yellow","yellow"],"solved":true,"timeLeft":40,"guesses":[{"index":0,"colors":["blue","blue","blue","blue"],"results":[{"color":"blue","status":"correct"},{"color":"blue","status":"incorrect"},{"color":"blue","status":"incorrect"},{"color":"blue","status":"incorrect"}],"isCorrect":false,"start":2601.8000000715256,"end":7868.800000071526,"duration":5267},{"index":1,"colors":["blue","green","green","green"],"results":[{"color":"blue","status":"correct"},{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"}],"isCorrect":false,"start":7868.800000071526,"end":11911.800000071526,"duration":4043},{"index":2,"colors":["yellow","yellow","yellow","yellow"],"results":[{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"correct"},{"color":"yellow","status":"correct"}],"isCorrect":false,"start":11911.800000071526,"end":16358.399999976158,"duration":4446.599999904633},{"index":3,"colors":["blue","red","red","red"],"results":[{"color":"blue","status":"correct"},{"color":"red","status":"correct"},{"color":"red","status":"incorrect"},{"color":"red","status":"incorrect"}],"isCorrect":false,"start":16358.399999976158,"end":21004.800000071526,"duration":4646.400000095367},{"index":4,"colors":["blue","red","yellow","yellow"],"results":[{"color":"blue","status":"correct"},{"color":"red","status":"correct"},{"color":"yellow","status":"correct"},{"color":"yellow","status":"correct"}],"isCorrect":true,"start":21004.800000071526,"end":26264.300000071526,"duration":5259.5}]}},{"type":"survey","index":1,"start":28036.800000071526,"end":29071.5,"duration":1034.6999999284744,"data":{"intensityOfEffort":1},"quitLastGame":false},{"type":"game","index":2,"start":29071.5,"end":30021.899999976158,"duration":950.3999999761581,"data":{"solution":["green","yellow","yellow","blue"],"solved":false,"timeLeft":15,"guesses":[]}},{"type":"survey","index":3,"start":30021.899999976158,"end":32843.700000047684,"duration":2821.8000000715256,"data":{"intensityOfEffort":3,"userVoiceResponse":{"blob":{},"url":"blob:http://localhost:3000/262d6968-903c-4b73-9d2e-4136478c0d79","timestamp":"2024-11-15T12:30:04.970Z"}},"quitLastGame":true},{"type":"game","index":4,"start":32843.700000047684,"end":55894.5,"duration":23050.799999952316,"data":{"solution":["red","red","green","blue"],"solved":false,"timeLeft":15,"guesses":[{"index":0,"colors":["blue","blue","blue","blue"],"results":[{"color":"blue","status":"incorrect"},{"color":"blue","status":"incorrect"},{"color":"blue","status":"incorrect"},{"color":"blue","status":"correct"}],"isCorrect":false,"start":32844.200000047684,"end":47738.700000047684,"duration":14894.5},{"index":1,"colors":["yellow","yellow","yellow","yellow"],"results":[{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"incorrect"}],"isCorrect":false,"start":47738.700000047684,"end":53528.60000002384,"duration":5789.899999976158}]}}]},"start":2600.3000000715256,"end":57113.800000071526,"duration":54513.5},{"index":4,"type":"Quest","name":"block_4_survey","data":{"userVoiceResponse":{"blob":{},"url":"blob:http://localhost:3000/8440eda6-b7fa-4225-b9c1-d82a8082e2b3","timestamp":"2024-11-15T12:30:31.889Z"},"ejoyment":4,"valence of effort":4,"senseofeffort":{"blob":{},"url":"blob:http://localhost:3000/bba5b9ad-39d2-4b5e-addb-7553fcc46ef5","timestamp":"2024-11-15T12:30:35.201Z"},"strategy usage":{"blob":{},"url":"blob:http://localhost:3000/606c2d00-0cce-4f10-9da2-f0bbd696e815","timestamp":"2024-11-15T12:30:37.034Z"},"effortsu":5,"helpfulsu":4,"boredom":2,"continue":{"blob":{},"url":"blob:http://localhost:3000/d7b761e9-5899-4823-aad1-f937fbc5529d","timestamp":"2024-11-15T12:30:40.563Z"}},"start":57113.800000071526,"end":69020.30000007153,"duration":11906.5},{"index":5,"type":"Text","name":"block_5_text","data":{},"start":69020.30000007153,"end":70449.39999997616,"duration":1429.0999999046326},{"index":6,"type":"MasterMindleWrapper","name":"block_5_mastermindle","data":{"blockpos":"1","feedbacktype":5,"timelimit":40,"data":[{"type":"game","index":0,"start":70449.89999997616,"end":76204.60000002384,"duration":5754.700000047684,"data":{"solution":["yellow","yellow","red","red"],"solved":false,"timeLeft":40,"guesses":[{"index":0,"colors":["blue","blue","blue","blue"],"results":[{"color":"blue","status":"incorrect"},{"color":"blue","status":"incorrect"},{"color":"blue","status":"incorrect"},{"color":"blue","status":"incorrect"}],"isCorrect":false,"start":70450,"end":73108.5,"duration":2658.5},{"index":1,"colors":["green","green","green","green"],"results":[{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"}],"isCorrect":false,"start":73108.5,"end":75657.10000002384,"duration":2548.600000023842}]}},{"type":"survey","index":1,"start":76204.60000002384,"end":78599.80000007153,"duration":2395.2000000476837,"data":{"intensityOfEffort":3,"userVoiceResponse":{"blob":{},"url":"blob:http://localhost:3000/fa30b9a8-f5ad-4c2a-93df-cdf508b4e3c6","timestamp":"2024-11-15T12:30:50.731Z"}},"quitLastGame":true},{"type":"game","index":2,"start":78599.80000007153,"end":93772.80000007153,"duration":15173,"data":{"solution":["red","blue","red","blue"],"solved":true,"timeLeft":35,"guesses":[{"index":0,"colors":["yellow","yellow","yellow","yellow"],"results":[{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"incorrect"},{"color":"yellow","status":"incorrect"}],"isCorrect":false,"start":78600.10000002384,"end":81749.10000002384,"duration":3149},{"index":1,"colors":["green","green","green","green"],"results":[{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"},{"color":"green","status":"incorrect"}],"isCorrect":false,"start":81749.10000002384,"end":84242.39999997616,"duration":2493.2999999523163},{"index":2,"colors":["red","red","blue","blue"],"results":[{"color":"red","status":"correct"},{"color":"red","status":"wrong-position"},{"color":"blue","status":"wrong-position"},{"color":"blue","status":"correct"}],"isCorrect":false,"start":84242.39999997616,"end":87377.5,"duration":3135.100000023842},{"index":3,"colors":["red","blue","red","blue"],"results":[{"color":"red","status":"correct"},{"color":"blue","status":"correct"},{"color":"red","status":"correct"},{"color":"blue","status":"correct"}],"isCorrect":true,"start":87377.5,"end":92099.89999997616,"duration":4722.399999976158}]}},{"type":"survey","index":3,"start":93772.80000007153,"end":94889.20000004768,"duration":1116.3999999761581,"data":{"intensityOfEffort":4},"quitLastGame":false},{"type":"game","index":4,"start":94889.20000004768,"end":140061.70000004768,"duration":45172.5,"data":{"solution":["green","blue","blue","green"],"solved":false,"timeLeft":20,"guesses":[{"index":0,"colors":["blue","blue","blue","blue"],"results":[{"color":"blue","status":"incorrect"},{"color":"blue","status":"correct"},{"color":"blue","status":"correct"},{"color":"blue","status":"incorrect"}],"isCorrect":false,"start":94889.60000002384,"end":139004.10000002384,"duration":44114.5}]}}]},"start":70449.39999997616,"end":141148,"duration":70698.60000002384},{"index":7,"type":"Quest","name":"block_5_survey","data":{"userVoiceResponse":{"blob":{},"url":"blob:http://localhost:3000/6e1cee6d-5e69-42fe-b7a1-88f8b0833e41","timestamp":"2024-11-15T12:31:55.900Z"},"ejoyment":4,"valence of effort":4,"senseofeffort":{"blob":{},"url":"blob:http://localhost:3000/767c5c98-6857-476c-9d26-af230e284b91","timestamp":"2024-11-15T12:31:59.287Z"},"strategy usage":{"blob":{},"url":"blob:http://localhost:3000/b7e4ee3d-30a5-4709-9577-e32e8176dbb6","timestamp":"2024-11-15T12:32:01.137Z"},"effortsu":4,"helpfulsu":5,"boredom":2,"continue":{"blob":{},"url":"blob:http://localhost:3000/2fd0466d-9476-4ba0-bd4e-20abff9599c3","timestamp":"2024-11-15T12:32:04.942Z"}},"start":141148,"end":153602.89999997616,"duration":12454.899999976158},{"index":8,"type":"Quest","name":"exitsurvey","data":{"cognionscale":2,"userVoiceResponse":{"blob":{},"url":"blob:http://localhost:3000/22d6fa6f-9e90-4687-8de3-d73cb8cf9f53","timestamp":"2024-11-15T12:32:09.345Z"}},"start":153602.89999997616,"end":159734.10000002384,"duration":6131.200000047684}]`  
  const data = JSON.parse(dummyJsonString)
  
  console.log(flattenObject(data))
  console.log(convertToCSV(data))

  expect(true);
})